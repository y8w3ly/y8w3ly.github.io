from Crypto.Util.number import long_to_bytes,inverse
from gmpy2 import gcdext

N = 9288011389664837847963670837039196937548434573294469245501561784245642854634445047

ciphertexts = [
    7827437377925724428078233147899924081225364249930858942421079276821876942757073519,
    8887391738833944793881713037947023989163050343070393147424888589467627754249865604,
    8081548039727189478984198619032683177557008617453299085364096689176320484341697433,
    2275794279542811986322743644529192750108107184530803067791576158460846098638595919,
    6253142316263707598596838911072529989608774170182629190175128689020135811837569575,
    4733751513227945548879795301848782446340444473234631092994528819564169644364997232,
    7059294752711247585748476830322929650455626597483726834273561488576645863895400850,
    3416115616735235302679100710807631760495960686259891905227746706138654756842094326,
    8925820570540264143648581237815478995705636946118008059750128065916255778832895553,
    2892105289971843001930724217759034130633547138605066058109243908372747042621581984,
    314392853155476706788704773868088966795343394149871206877830575819199838027511362,
    4327945167964771727885647567828770187834470062965467452997985192630056416939883267,
    5004179351047061632898561578033712835850283897910028694457603173176131447102750100
]


    
rs = []
for i in range(len(ciphertexts) - 1):
    c_current = ciphertexts[i]
    c_next = ciphertexts[i+1]
    

    c_cubed = pow(c_current, 3, N)
    c_cubed_inv = inverse(c_cubed, N)
    

    R = (c_next * c_cubed_inv) % N
    rs.append(R)

abc = sorted(list(set(rs)))



middle = None
others = []

A, B, C = abc
if pow(A, 2, N) == (B * C) % N:
    middle = A
    others = [B, C]
elif pow(B, 2, N) == (A * C) % N:
    middle = B
    others = [A, C]
elif pow(C, 2, N) == (A * B) % N:
    middle = C
    others = [A, B]

candidates = []

for start_val in others:
    X_candidate = start_val 
    Y_candidate = (middle * inverse(start_val, N)) % N 
    candidates.append((X_candidate, Y_candidate))

g, u, v = gcdext(1337, N)

for i, (X, Y) in enumerate(candidates):
    Y_inv = inverse(Y, N) 
    

    term1 = pow(X, u, N)
    term2 = pow(Y_inv, v, N)
    m = (term1 * term2) % N
    flag = long_to_bytes(m)
    if b"Alpaca" in flag:
        print(flag)